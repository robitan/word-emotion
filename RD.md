単語 × 感情 ベクトル空間構築・比較システム

概要設計書（RD）

⸻

1. 目的

本システムは、「単語と感情の紐付け」データをもとに、
• 異なる学習方針で構築した 複数の感情指向ベクトル空間
• 元データの コレスポンデンス分析（CA）結果

を 同一 UI 上で比較・検証できる状態を作ることを目的とする。

これにより以下を検証する：
• 感情ラベルを用いた学習が、単語の意味空間をどのように変形するか
• 類似検索・感情変化演算に適した空間はどれか
• CA（統計的構造）と埋め込み空間（幾何構造）がどの程度整合しているか

⸻

2. 全体構成

2.1 コンポーネント
• Embedding 生成モジュール
• 学習モジュール（BCE / Triplet）
• ベクトル DB（3 コレクション）
• 分析モジュール（コレスポンデンス分析）
• 比較 UI

⸻

3. 共通前提

3.1 埋め込み入力形式（全 DB 共通）

"{word} という単語が示す感情"

    •	単語そのものではなく「感情意味」に寄せた空間を形成する
    •	Baseline / BCE / Triplet すべてで同一入力を使用する

3.2 既存配布モデル
• BAAI/bge-m3
• 出力ベクトル次元：1024
• 距離尺度：Cosine similarity
• 出力は正規化（L2 normalize）して使用

⸻

4. ベクトル DB 設計

4.1 方式
• 方式 A：3 コレクションを独立に作成
• 比較・検証を主目的とするため、完全分離を優先

4.2 コレクション一覧

コレクション名 内容
words_baseline 既存モデルのみ
words_bce BCE 学習後
words_triplet Triplet 学習後

4.3 登録データ（共通）
• vector: 埋め込みベクトル
• payload:
• word
• 入力テキスト
• 感情ラベル（存在する場合）
• 元データ ID

⸻

5. DB① Baseline 空間

5.1 目的
• 学習による空間変形の比較基準

5.2 構築方法 1. 各単語 w について入力文を生成 2. v_base(w) = normalize(E(text)) 3. words_baseline に登録

⸻

6. DB② BCE 学習空間（類似検索特化）

6.1 目的
• 感情が近い単語同士が近傍に配置される空間を構築
• 類似単語検索の精度向上

6.2 学習データ
• 単語ペア (w_i, w_j)
• Positive: 感情が近い
• Negative: 感情が遠い

6.3 計算方式（BCE）
• 埋め込み：

u = g(f(w_i))
v = g(f(w_j))

    •	類似度：

s = α \* cosine(u, v)

    •	損失：

BCEWithLogitsLoss(s, y)

6.4 登録
• 学習済みエンコーダ g を使用
• v_bce(w) = normalize(g(f(w)))
• words_bce に登録

⸻

7. DB③ Triplet 学習空間（感情変化演算特化）

7.1 目的
• 単語 + 感情方向ベクトルによる意味変化を成立させる
• 感情アナロジー的操作の検証

7.2 学習データ
• Triplet (anchor, positive, negative)
• anchor: 単語 a
• positive: 感情が近い単語
• negative: 感情が遠い単語

7.3 計算方式（Triplet）
• 距離：

d(x,y) = 1 - cosine(x,y)

    •	損失：

max(0, d(a,p) - d(a,n) + margin)

7.4 登録
• v_triplet(w) = normalize(g(f(w)))
• words_triplet に登録

⸻

8. 感情変化ベクトルの構築（Triplet 空間）

8.1 案 1：平均との差分

Δe = mean(v(S+)) - mean(v(S-))

8.2 案 2：プロトタイプ差分

p_k = mean(v(S_k))
Δe = p_target - p_source

8.3 検索クエリ

q = normalize(v(w) + λ \* Δe)

    •	λ はUIで調整可能

⸻

9. コレスポンデンス分析（CA）

9.1 入力
• 単語 × 感情カテゴリのクロス集計行列

9.2 出力
• 単語・感情を同一 2D 平面に配置
• 寄与率・成分情報

⸻

10. CA と ベクトル空間の整合性評価

10.1 方法 A：近傍一致率
• CA 平面での近傍集合 N_CA(w)
• ベクトル空間での近傍集合 N_DB(w)
• 指標：
• Overlap@k
• Jaccard 係数

10.2 方法 B：距離相関
• CA 距離：

d_CA(i,j) = ||c_i - c_j||

    •	ベクトル距離：

d_DB(i,j) = 1 - cosine(v_i, v_j)

    •	Spearman順位相関を算出

⸻

11. UI 要件

11.1 DB 選択
• Baseline / BCE / Triplet を切替
• 同一クエリの横並び比較を可能にする

11.2 類似検索
• 入力：単語
• 出力：Top-K 類似単語

11.3 感情変化検索
• 入力：単語
• 感情方向：案 1 / 案 2 切替
• λ 調整スライダー

11.4 CA 可視化
• 2D 散布図
• 単語クリックで近傍比較表示

⸻

12. 評価観点
    • 類似語の妥当性
    • 感情変化の直感的一貫性
    • CA 構造との局所・大域的一致度
